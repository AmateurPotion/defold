#! /usr/bin/env python

from waf_dynamo import platform_supports_feature

def build(bld):
    for name in ['test_graphics', 'test_glsl_uniform_parser']:
        bld.new_task_gen(features = 'cxx cprogram test',
                         includes = ['../../src', '../../proto'],
                         exported_symbols = ['GraphicsAdapterNull'],
                         source = name + '.cpp',
                         uselib = 'APP DDF DLIB',
                         uselib_local = 'graphics_null',
                         target = name)

    if platform_supports_feature(bld.env.PLATFORM, 'vulkan', {}) and bld.env['PLATFORM'] not in ('x86_64-linux'):
        bld.new_task_gen(features = 'cxx cprogram test skip_test',
                         includes = ['../../src', '../../proto'],
                         exported_symbols = ['GraphicsAdapterVulkan'],
                         source = 'test_app_vulkan.cpp',
                         uselib = 'APP PLATFORM DDF DLIB DMGLFW VULKAN',
                         uselib_local = 'graphics_vulkan',
                         target = 'test_app_vulkan')
